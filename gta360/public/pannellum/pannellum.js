// Pannellum b312327, https://github.com/mpetroff/pannellum
window.libpannellum=function(y,l,h){function ia($){function S(a,f){return 1==a.level&&1!=f.level?-1:1==f.level&&1!=a.level?1:f.timestamp-a.timestamp}function ea(a,f){return a.level!=f.level?a.level-f.level:a.diff-f.diff}function J(a,f,e,l,q,c){this.vertices=a;this.side=f;this.level=e;this.x=l;this.y=q;this.path=c.replace("%s",f).replace("%l",e).replace("%x",l).replace("%y",q)}function ta(a,f,l,m,q){var c;var k=f.vertices;c=aa(a,k.slice(0,3));var s=aa(a,k.slice(3,6)),h=aa(a,k.slice(6,9)),k=aa(a,k.slice(9,
12)),z=c[0]+s[0]+h[0]+k[0];-4==z||4==z?c=!1:(z=c[1]+s[1]+h[1]+k[1],c=-4==z||4==z?!1:4!=c[2]+s[2]+h[2]+k[2]);if(c){c=f.vertices;s=c[0]+c[3]+c[6]+c[9];h=c[1]+c[4]+c[7]+c[10];k=c[2]+c[5]+c[8]+c[11];z=Math.sqrt(s*s+h*h+k*k);k=Math.asin(k/z);s=Math.atan2(h,s)-m;s+=s>Math.PI?-2*Math.PI:s<-Math.PI?2*Math.PI:0;s=Math.abs(s);f.diff=Math.acos(Math.sin(l)*Math.sin(k)+Math.cos(l)*Math.cos(k)*Math.cos(s));s=!1;for(h=0;h<e.nodeCache.length;h++)if(e.nodeCache[h].path==f.path){s=!0;e.nodeCache[h].timestamp=e.nodeCacheTimestamp++;
e.nodeCache[h].diff=f.diff;e.currentNodes.push(e.nodeCache[h]);break}s||(f.timestamp=e.nodeCacheTimestamp++,e.currentNodes.push(f),e.nodeCache.push(f));if(f.level<e.level){var k=r.cubeResolution*Math.pow(2,f.level-r.maxLevel),s=Math.ceil(k*r.invTileResolution)-1,h=k%r.tileResolution*2,A=2*k%r.tileResolution;0===A&&(A=r.tileResolution);0===h&&(h=2*r.tileResolution);z=0.5;if(f.x==s||f.y==s)z=1-r.tileResolution/(r.tileResolution+A);var v=1-z,k=[],y=z,O=z,C=z,I=v,w=v,x=v;if(A<r.tileResolution)if(f.x==
s&&f.y!=s){if(w=O=0.5,"d"==f.side||"u"==f.side)x=C=0.5}else f.x!=s&&f.y==s&&(I=y=0.5,"l"==f.side||"r"==f.side)&&(x=C=0.5);h<=r.tileResolution&&(f.x==s&&(y=0,I=1,"l"==f.side||"r"==f.side)&&(C=0,x=1),f.y==s&&(O=0,w=1,"d"==f.side||"u"==f.side)&&(C=0,x=1));A=[c[0],c[1],c[2],c[0]*y+c[3]*I,c[1]*z+c[4]*v,c[2]*C+c[5]*x,c[0]*y+c[6]*I,c[1]*O+c[7]*w,c[2]*C+c[8]*x,c[0]*z+c[9]*v,c[1]*O+c[10]*w,c[2]*C+c[11]*x];A=new J(A,f.side,f.level+1,2*f.x,2*f.y,r.fullpath);k.push(A);f.x==s&&h<=r.tileResolution||(A=[c[0]*y+
c[3]*I,c[1]*z+c[4]*v,c[2]*C+c[5]*x,c[3],c[4],c[5],c[3]*z+c[6]*v,c[4]*O+c[7]*w,c[5]*C+c[8]*x,c[0]*y+c[6]*I,c[1]*O+c[7]*w,c[2]*C+c[8]*x],A=new J(A,f.side,f.level+1,2*f.x+1,2*f.y,r.fullpath),k.push(A));f.x==s&&h<=r.tileResolution||f.y==s&&h<=r.tileResolution||(A=[c[0]*y+c[6]*I,c[1]*O+c[7]*w,c[2]*C+c[8]*x,c[3]*z+c[6]*v,c[4]*O+c[7]*w,c[5]*C+c[8]*x,c[6],c[7],c[8],c[9]*y+c[6]*I,c[10]*z+c[7]*v,c[11]*C+c[8]*x],A=new J(A,f.side,f.level+1,2*f.x+1,2*f.y+1,r.fullpath),k.push(A));f.y==s&&h<=r.tileResolution||(A=
[c[0]*z+c[9]*v,c[1]*O+c[10]*w,c[2]*C+c[11]*x,c[0]*y+c[6]*I,c[1]*O+c[7]*w,c[2]*C+c[8]*x,c[9]*y+c[6]*I,c[10]*z+c[7]*v,c[11]*C+c[8]*x,c[9],c[10],c[11]],A=new J(A,f.side,f.level+1,2*f.x,2*f.y+1,r.fullpath),k.push(A));for(f=0;f<k.length;f++)ta(a,k[f],l,m,q)}}}function ua(){return[-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,1,1,-1,1,1,-1,-1]}function ka(a,f,e){var h=Math.sin(f);f=Math.cos(f);
if("x"==e)return[a[0],f*a[1]+h*a[2],f*a[2]-h*a[1],a[3],f*a[4]+h*a[5],f*a[5]-h*a[4],a[6],f*a[7]+h*a[8],f*a[8]-h*a[7]];if("y"==e)return[f*a[0]-h*a[2],a[1],f*a[2]+h*a[0],f*a[3]-h*a[5],a[4],f*a[5]+h*a[3],f*a[6]-h*a[8],a[7],f*a[8]+h*a[6]];if("z"==e)return[f*a[0]+h*a[1],f*a[1]-h*a[0],a[2],f*a[3]+h*a[4],f*a[4]-h*a[3],a[5],f*a[6]+h*a[7],f*a[7]-h*a[6],a[8]]}function fa(a){return[a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]]}function va(a){a.textureLoad||(a.textureLoad=
!0,Ea(encodeURI(a.path+"."+r.extension),function(f){a.texture=f;a.textureLoaded=!0}))}function aa(a,f){var e=[a[0]*f[0]+a[1]*f[1]+a[2]*f[2],a[4]*f[0]+a[5]*f[1]+a[6]*f[2],a[11]+a[8]*f[0]+a[9]*f[1]+a[10]*f[2],1/(a[12]*f[0]+a[13]*f[1]+a[14]*f[2])],h=e[0]*e[3],l=e[1]*e[3],e=e[2]*e[3],c=[0,0,0];-1>h&&(c[0]=-1);1<h&&(c[0]=1);-1>l&&(c[1]=-1);1<l&&(c[1]=1);if(-1>e||1<e)c[2]=1;return c}var v=l.createElement("canvas");v.style.width=v.style.height="100%";$.appendChild(v);var e,a,K,L,wa,R,la,ba,r,x,ga,D,X,ma,
V;this.init=function(g,f,y,sa,q,c,k,s){typeof f===h&&(f="equirectangular");x=f;r=g;ga=y;if(e){K&&(a.detachShader(e,K),a.deleteShader(K));L&&(a.detachShader(e,L),a.deleteShader(L));a.bindBuffer(a.ARRAY_BUFFER,null);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null);e.texture&&a.deleteTexture(e.texture);if(e.nodeCache)for(g=0;g<e.nodeCache.length;g++)a.deleteTexture(e.nodeCache[g].texture);a.deleteProgram(e);e=h}ba=h;"cubemap"==x&&0!==(r[0].width&r[0].width-1)&&(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)||
navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 9_/)||navigator.userAgent.match(/Trident.*rv[ :]*11\./))||a||(a=v.getContext("experimental-webgl",{alpha:!1,depth:!1}));if(!a&&("multires"==x&&r.hasOwnProperty("fallbackPath")||"cubemap"==x)&&("WebkitAppearance"in l.documentElement.style||navigator.userAgent.match(/Trident.*rv[ :]*11\./)||-1!==navigator.appVersion.indexOf("MSIE 10"))){R&&$.removeChild(R);R=l.createElement("div");R.className="pnlm-world";sa=r.basePath?r.basePath+r.fallbackPath:
r.fallbackPath;var ja="frblud".split(""),z=0;q=function(){var a=l.createElement("canvas");a.className="pnlm-face pnlm-"+ja[this.side]+"face";R.appendChild(a);var c=a.getContext("2d");a.style.width=this.width+4+"px";a.style.height=this.height+4+"px";a.width=this.width+4;a.height=this.height+4;c.drawImage(this,2,2);var f=c.getImageData(0,0,a.width,a.height),e=f.data,h,g;for(h=2;h<a.width-2;h++)for(g=0;4>g;g++)e[4*(h+a.width)+g]=e[4*(h+2*a.width)+g],e[4*(h+a.width*(a.height-2))+g]=e[4*(h+a.width*(a.height-
3))+g];for(h=2;h<a.height-2;h++)for(g=0;4>g;g++)e[4*(h*a.width+1)+g]=e[4*(h*a.width+2)+g],e[4*((h+1)*a.width-2)+g]=e[4*((h+1)*a.width-3)+g];for(g=0;4>g;g++)e[4*(a.width+1)+g]=e[4*(2*a.width+2)+g],e[4*(2*a.width-2)+g]=e[4*(3*a.width-3)+g],e[4*(a.width*(a.height-2)+1)+g]=e[4*(a.width*(a.height-3)+2)+g],e[4*(a.width*(a.height-1)-2)+g]=e[4*(a.width*(a.height-2)-3)+g];for(h=1;h<a.width-1;h++)for(g=0;4>g;g++)e[4*h+g]=e[4*(h+a.width)+g],e[4*(h+a.width*(a.height-1))+g]=e[4*(h+a.width*(a.height-2))+g];for(h=
1;h<a.height-1;h++)for(g=0;4>g;g++)e[h*a.width*4+g]=e[4*(h*a.width+1)+g],e[4*((h+1)*a.width-1)+g]=e[4*((h+1)*a.width-2)+g];for(g=0;4>g;g++)e[g]=e[4*(a.width+1)+g],e[4*(a.width-1)+g]=e[4*(2*a.width-2)+g],e[a.width*(a.height-1)*4+g]=e[4*(a.width*(a.height-2)+1)+g],e[4*(a.width*a.height-1)+g]=e[4*(a.width*(a.height-1)-2)+g];c.putImageData(f,0,0);z++;6==z&&(wa=this.width,$.appendChild(R),k())};for(g=0;6>g;g++)c=new Image,c.crossOrigin="anonymous",c.side=g,c.onload=q,c.src="multires"==x?encodeURI(sa.replace("%s",
ja[g])+"."+r.extension):encodeURI(r[g].src)}else{if(!a)throw console.log("Error: no WebGL support detected!"),{type:"no webgl"};r.fullpath=r.basePath?r.basePath+r.path:r.path;r.invTileResolution=1/r.tileResolution;f=ua();la=[];for(g=0;6>g;g++)la[g]=f.slice(12*g,12*g+12),f=ua();if("equirectangular"==x){if(g=Math.max(r.width,r.height),f=a.getParameter(a.MAX_TEXTURE_SIZE),g>f)throw console.log("Error: The image is too big; it's "+g+"px wide, but this device's maximum supported width is "+f+"px."),{type:"webgl size error",
width:g,maxWidth:f};}else if("cubemap"==x&&(g=r[0].width,f=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),g>f))throw console.log("Error: The cube face image is too big; it's "+g+"px wide, but this device's maximum supported width is "+f+"px."),{type:"webgl size error",width:g,maxWidth:f};s===h||s.horizonPitch===h&&s.horizonRoll===h||(ba=[s.horizonPitch==h?0:s.horizonPitch,s.horizonRoll==h?0:s.horizonRoll]);g=a.TEXTURE_2D;a.viewport(0,0,v.width,v.height);K=a.createShader(a.VERTEX_SHADER);f=m;"multires"==
x&&(f=w);a.shaderSource(K,f);a.compileShader(K);L=a.createShader(a.FRAGMENT_SHADER);f=na;"cubemap"==x?(g=a.TEXTURE_CUBE_MAP,f=Fa):"multires"==x&&(f=oa);a.shaderSource(L,f);a.compileShader(L);e=a.createProgram();a.attachShader(e,K);a.attachShader(e,L);a.linkProgram(e);a.getShaderParameter(K,a.COMPILE_STATUS)||console.log(a.getShaderInfoLog(K));a.getShaderParameter(L,a.COMPILE_STATUS)||console.log(a.getShaderInfoLog(L));a.getProgramParameter(e,a.LINK_STATUS)||console.log(a.getProgramInfoLog(e));a.useProgram(e);
e.drawInProgress=!1;e.texCoordLocation=a.getAttribLocation(e,"a_texCoord");a.enableVertexAttribArray(e.texCoordLocation);"multires"!=x?(D||(D=a.createBuffer()),a.bindBuffer(a.ARRAY_BUFFER,D),a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,1,1,1,1,-1,-1,1,1,-1,-1,-1]),a.STATIC_DRAW),a.vertexAttribPointer(e.texCoordLocation,2,a.FLOAT,!1,0,0),e.aspectRatio=a.getUniformLocation(e,"u_aspectRatio"),a.uniform1f(e.aspectRatio,v.width/v.height),e.psi=a.getUniformLocation(e,"u_psi"),e.theta=a.getUniformLocation(e,
"u_theta"),e.f=a.getUniformLocation(e,"u_f"),e.h=a.getUniformLocation(e,"u_h"),e.v=a.getUniformLocation(e,"u_v"),e.vo=a.getUniformLocation(e,"u_vo"),e.rot=a.getUniformLocation(e,"u_rot"),a.uniform1f(e.h,sa/(2*Math.PI)),a.uniform1f(e.v,q/Math.PI),a.uniform1f(e.vo,c/Math.PI*2),"equirectangular"==x&&(e.backgroundColor=a.getUniformLocation(e,"u_backgroundColor"),a.uniform4fv(e.backgroundColor,(s.backgroundColor?s.backgroundColor:[0,0,0]).concat([1]))),e.texture=a.createTexture(),a.bindTexture(g,e.texture),
"cubemap"==x?(a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r[1]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_X,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r[3]),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Y,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r[4]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r[5]),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Z,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r[0]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r[2])):a.texImage2D(g,
0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r),a.texParameteri(g,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(g,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(g,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(g,a.TEXTURE_MAG_FILTER,a.LINEAR)):(e.vertPosLocation=a.getAttribLocation(e,"a_vertCoord"),a.enableVertexAttribArray(e.vertPosLocation),X||(X=a.createBuffer()),ma||(ma=a.createBuffer()),V||(V=a.createBuffer()),a.bindBuffer(a.ARRAY_BUFFER,ma),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,
0,1]),a.STATIC_DRAW),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,V),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),a.STATIC_DRAW),e.perspUniform=a.getUniformLocation(e,"u_perspMatrix"),e.cubeUniform=a.getUniformLocation(e,"u_cubeMatrix"),e.level=-1,e.currentNodes=[],e.nodeCache=[],e.nodeCacheTimestamp=0);if(0!==a.getError())throw console.log("Error: Something went wrong with WebGL!"),{type:"webgl error"};k()}};this.destroy=function(){$!==h&&(v!==h&&$.removeChild(v),R!==h&&$.removeChild(R))};
this.resize=function(){var h=y.devicePixelRatio||1;v.width=v.clientWidth*h;v.height=v.clientHeight*h;a&&(a.viewport(0,0,v.width,v.height),"multires"!=x&&a.uniform1f(e.aspectRatio,v.width/v.height))};this.resize();this.render=function(g,f,l,m){var q;q=0;m===h&&(m={});m.roll&&(q=m.roll);if(ba!==h){var c=ba[0],k=ba[1],s=g,w=f,z=Math.cos(k)*Math.sin(g)*Math.sin(c)+Math.cos(g)*(Math.cos(c)*Math.cos(f)+Math.sin(k)*Math.sin(c)*Math.sin(f)),A=-Math.sin(g)*Math.sin(k)+Math.cos(g)*Math.cos(k)*Math.sin(f);g=
Math.cos(k)*Math.cos(c)*Math.sin(g)+Math.cos(g)*(-Math.cos(f)*Math.sin(c)+Math.cos(c)*Math.sin(k)*Math.sin(f));g=Math.asin(Math.max(Math.min(g,1),-1));f=Math.atan2(A,z);c=[Math.cos(s)*(Math.sin(k)*Math.sin(c)*Math.cos(w)-Math.cos(c)*Math.sin(w)),Math.cos(s)*Math.cos(k)*Math.cos(w),Math.cos(s)*(Math.cos(c)*Math.sin(k)*Math.cos(w)+Math.sin(w)*Math.sin(c))];k=[-Math.cos(g)*Math.sin(f),Math.cos(g)*Math.cos(f)];k=Math.acos(Math.max(Math.min((c[0]*k[0]+c[1]*k[1])/(Math.sqrt(c[0]*c[0]+c[1]*c[1]+c[2]*c[2])*
Math.sqrt(k[0]*k[0]+k[1]*k[1])),1),-1));0>c[2]&&(k=2*Math.PI-k);q+=k}if(a||"multires"!=x&&"cubemap"!=x){if("multires"!=x)l=2*Math.atan(Math.tan(0.5*l)/(v.width/v.height)),l=1/Math.tan(0.5*l),a.uniform1f(e.psi,f),a.uniform1f(e.theta,g),a.uniform1f(e.rot,q),a.uniform1f(e.f,l),!0===ga&&"equirectangular"==x&&(a.bindTexture(a.TEXTURE_2D,e.texture),a.texImage2D(a.TEXTURE_2D,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r)),a.drawArrays(a.TRIANGLES,0,6);else{c=v.width/v.height;k=2*Math.atan(Math.tan(l/2)*v.height/v.width);
k=1/Math.tan(k/2);c=[k/c,0,0,0,0,k,0,0,0,0,100.1/-99.9,20/-99.9,0,0,-1,0];for(k=1;k<r.maxLevel&&v.width>r.tileResolution*Math.pow(2,k-1)*Math.tan(l/2)*0.707;)k++;e.level=k;k=[1,0,0,0,1,0,0,0,1];k=ka(k,-q,"z");k=ka(k,-g,"x");k=ka(k,f,"y");k=[k[0],k[1],k[2],0,k[3],k[4],k[5],0,k[6],k[7],k[8],0,0,0,0,1];a.uniformMatrix4fv(e.perspUniform,!1,new Float32Array(fa(c)));a.uniformMatrix4fv(e.cubeUniform,!1,new Float32Array(fa(k)));c=[c[0]*k[0],c[0]*k[1],c[0]*k[2],0,c[5]*k[4],c[5]*k[5],c[5]*k[6],0,c[10]*k[8],
c[10]*k[9],c[10]*k[10],c[11],-k[8],-k[9],-k[10],0];e.nodeCache.sort(S);if(200<e.nodeCache.length&&e.nodeCache.length>e.currentNodes.length+50)for(k=e.nodeCache.splice(200,e.nodeCache.length-200),q=0;q<k.length;q++)a.deleteTexture(k[q].texture);e.currentNodes=[];k="fbudlr".split("");for(q=0;6>q;q++)s=new J(la[q],k[q],1,0,0,r.fullpath),ta(c,s,g,f,l);e.currentNodes.sort(ea);for(q=0;q<e.currentNodes.length;q++)if(!e.currentNodes[q].texture){setTimeout(va(e.currentNodes[q]),0);break}if(!e.drawInProgress){e.drawInProgress=
!0;for(g=0;g<e.currentNodes.length;g++)e.currentNodes[g].textureLoaded&&(a.bindBuffer(a.ARRAY_BUFFER,X),a.bufferData(a.ARRAY_BUFFER,new Float32Array(e.currentNodes[g].vertices),a.STATIC_DRAW),a.vertexAttribPointer(e.vertPosLocation,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,ma),a.vertexAttribPointer(e.texCoordLocation,2,a.FLOAT,!1,0,0),a.bindTexture(a.TEXTURE_2D,e.currentNodes[g].texture),a.drawElements(a.TRIANGLES,6,a.UNSIGNED_SHORT,0));e.drawInProgress=!1}}if(m.returnImage!==h)return v.toDataURL("image/png")}else for(q=
wa/2,m={f:"translate3d(-"+(q+2)+"px, -"+(q+2)+"px, -"+q+"px)",b:"translate3d("+(q+2)+"px, -"+(q+2)+"px, "+q+"px) rotateX(180deg) rotateZ(180deg)",u:"translate3d(-"+(q+2)+"px, -"+q+"px, "+(q+2)+"px) rotateX(270deg)",d:"translate3d(-"+(q+2)+"px, "+q+"px, -"+(q+2)+"px) rotateX(90deg)",l:"translate3d(-"+q+"px, -"+(q+2)+"px, "+(q+2)+"px) rotateX(180deg) rotateY(90deg) rotateZ(180deg)",r:"translate3d("+q+"px, -"+(q+2)+"px, -"+(q+2)+"px) rotateY(270deg)"},l=1/Math.tan(l/2),l=l*v.width/(y.devicePixelRatio||
1)/2+"px",g="perspective("+l+") translateZ("+l+") rotateX("+g+"rad) rotateY("+f+"rad) ",f=Object.keys(m),q=0;6>q;q++)l=R.querySelector(".pnlm-"+f[q]+"face").style,l.webkitTransform=g+m[f[q]],l.transform=g+m[f[q]]};this.isLoading=function(){if(a&&"multires"==x)for(var h=0;h<e.currentNodes.length;h++)if(!e.currentNodes[h].textureLoaded)return!0;return!1};this.getCanvas=function(){return v};var Ea=function(){function e(){var c=this;this.texture=this.callback=null;this.image=new Image;this.image.crossOrigin=
"anonymous";this.image.addEventListener("load",function(){var e=c.image;a.bindTexture(a.TEXTURE_2D,c.texture);a.texImage2D(a.TEXTURE_2D,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,e);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.bindTexture(a.TEXTURE_2D,null);c.callback(c.texture);m.length?(e=m.shift(),c.loadTexture(e.src,
e.texture,e.callback)):l[h++]=c})}function f(a,c,e){this.src=a;this.texture=c;this.callback=e}var h=4,l={},m=[];e.prototype.loadTexture=function(a,c,e){this.texture=c;this.callback=e;this.image.src=a};for(var c=0;c<h;c++)l[c]=new e;return function(c,e){var g=a.createTexture();h?l[--h].loadTexture(c,g,e):m.push(new f(c,g,e));return g}}()}var m="attribute vec2 a_texCoord;varying vec2 v_texCoord;void main() {gl_Position = vec4(a_texCoord, 0.0, 1.0);v_texCoord = a_texCoord;}",w="attribute vec3 a_vertCoord;attribute vec2 a_texCoord;uniform mat4 u_cubeMatrix;uniform mat4 u_perspMatrix;varying mediump vec2 v_texCoord;void main(void) {gl_Position = u_perspMatrix * u_cubeMatrix * vec4(a_vertCoord, 1.0);v_texCoord = a_texCoord;}",
Fa="precision mediump float;\nuniform float u_aspectRatio;\nuniform float u_psi;\nuniform float u_theta;\nuniform float u_f;\nuniform float u_h;\nuniform float u_v;\nuniform float u_vo;\nuniform float u_rot;\nconst float PI = 3.14159265358979323846264;\nuniform sampler2D u_image;\nuniform samplerCube u_imageCube;\nvarying vec2 v_texCoord;\nuniform vec4 u_backgroundColor;\nvoid main() {\nfloat x = v_texCoord.x * u_aspectRatio;\nfloat y = v_texCoord.y;\nfloat sinrot = sin(u_rot);\nfloat cosrot = cos(u_rot);\nfloat rot_x = x * cosrot - y * sinrot;\nfloat rot_y = x * sinrot + y * cosrot;\nfloat sintheta = sin(u_theta);\nfloat costheta = cos(u_theta);\nfloat a = u_f * costheta - rot_y * sintheta;\nfloat root = sqrt(rot_x * rot_x + a * a);\nfloat lambda = atan(rot_x / root, a / root) + u_psi;\nfloat phi = atan((rot_y * costheta + u_f * sintheta) / root);float cosphi = cos(phi);\ngl_FragColor = textureCube(u_imageCube, vec3(cosphi*sin(lambda), sin(phi), cosphi*cos(lambda)));\n}",
na="precision mediump float;\nuniform float u_aspectRatio;\nuniform float u_psi;\nuniform float u_theta;\nuniform float u_f;\nuniform float u_h;\nuniform float u_v;\nuniform float u_vo;\nuniform float u_rot;\nconst float PI = 3.14159265358979323846264;\nuniform sampler2D u_image;\nuniform samplerCube u_imageCube;\nvarying vec2 v_texCoord;\nuniform vec4 u_backgroundColor;\nvoid main() {\nfloat x = v_texCoord.x * u_aspectRatio;\nfloat y = v_texCoord.y;\nfloat sinrot = sin(u_rot);\nfloat cosrot = cos(u_rot);\nfloat rot_x = x * cosrot - y * sinrot;\nfloat rot_y = x * sinrot + y * cosrot;\nfloat sintheta = sin(u_theta);\nfloat costheta = cos(u_theta);\nfloat a = u_f * costheta - rot_y * sintheta;\nfloat root = sqrt(rot_x * rot_x + a * a);\nfloat lambda = atan(rot_x / root, a / root) + u_psi;\nfloat phi = atan((rot_y * costheta + u_f * sintheta) / root);lambda = mod(lambda + PI, PI * 2.0) - PI;\nvec2 coord = vec2(lambda / PI, phi / (PI / 2.0));\nif(coord.x < -u_h || coord.x > u_h || coord.y < -u_v + u_vo || coord.y > u_v + u_vo)\ngl_FragColor = u_backgroundColor;\nelse\ngl_FragColor = texture2D(u_image, vec2((coord.x + u_h) / (u_h * 2.0), (-coord.y + u_v + u_vo) / (u_v * 2.0)));\n}",
oa="varying mediump vec2 v_texCoord;uniform sampler2D u_sampler;void main(void) {gl_FragColor = texture2D(u_sampler, v_texCoord);}";return{renderer:function(h,l,m,w){return new ia(h,l,m,w)}}}(window,document);window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(y,l){window.setTimeout(y,1E3/60)}}());
window.pannellum=function(y,l,h){function ia(m,w){function Fa(){var a=l.createElement("div");a.innerHTML="\x3c!--[if lte IE 9]><i></i><![endif]--\x3e";if(1==a.getElementsByTagName("i").length)S();else{xa=b.hfov;ya=b.pitch;var d;if("cubemap"==b.type){M=[];for(a=0;6>a;a++)M.push(new Image),M[a].crossOrigin="anonymous";p.load.lbox.style.display="block";p.load.lbar.style.display="none"}else if("multires"==b.type)a=JSON.parse(JSON.stringify(b.multiRes)),b.basePath&&b.multiRes.basePath&&!/^(?:[a-z]+:)?\/\//i.test(b.multiRes.basePath)?
a.basePath=b.basePath+b.multiRes.basePath:b.multiRes.basePath?a.basePath=b.multiRes.basePath:b.basePath&&(a.basePath=b.basePath),M=a;else if(!0===b.dynamic)M=b.panorama;else{if(b.panorama===h){S("No panorama image was specified.");return}M=new Image}if("cubemap"==b.type)for(var c=6,e=function(){c--;0===c&&oa()},f=function(a){var E=l.createElement("a");E.href=a.target.src;E.innerHTML=E.href;S("The file "+E.outerHTML+" could not be accessed.")},a=0;a<M.length;a++)M[a].onload=e,M[a].onerror=f,d=b.cubeMap[a],
b.basePath&&!na(d)&&(d=b.basePath+d),M[a].src=encodeURI(d);else if("multires"==b.type)oa();else if(d="",b.basePath&&(d=b.basePath),!0!==b.dynamic){d=na(b.panorama)?b.panorama:d+b.panorama;M.onload=function(){y.URL.revokeObjectURL(this.src);oa()};var g=new XMLHttpRequest;g.onloadend=function(){if(200!=g.status){var a=l.createElement("a");a.href=encodeURI(d);a.innerHTML=a.href;S("The file "+a.outerHTML+" could not be accessed.")}$(this.response);p.load.msg.innerHTML=""};g.onprogress=function(a){if(a.lengthComputable){p.load.lbarFill.style.width=
a.loaded/a.total*100+"%";var E,d;1E6<a.total?(E="MB",d=(a.loaded/1E6).toFixed(2),a=(a.total/1E6).toFixed(2)):1E3<a.total?(E="kB",d=(a.loaded/1E3).toFixed(1),a=(a.total/1E3).toFixed(1)):(E="B",d=a.loaded,a=a.total);p.load.msg.innerHTML=d+" / "+a+" "+E}else p.load.lbox.style.display="block",p.load.lbar.style.display="none"};try{g.open("GET",d,!0)}catch(k){S("There is something wrong with the panorama URL.")}g.responseType="blob";g.setRequestHeader("Accept","image/*,*/*;q=0.9");g.send()}m.classList.add("pnlm-grab");
m.classList.remove("pnlm-grabbing")}}function na(a){return/^(?:[a-z]+:)?\/\//i.test(a)|"/"==a[0]}function oa(){B||(B=new libpannellum.renderer(G));La||(La=!0,F.addEventListener("mousedown",ta,!1),l.addEventListener("mousemove",ka,!1),l.addEventListener("mouseup",fa,!1),b.mouseZoom&&(m.addEventListener("mousewheel",L,!1),m.addEventListener("DOMMouseScroll",L,!1)),m.addEventListener("mozfullscreenchange",z,!1),m.addEventListener("webkitfullscreenchange",z,!1),m.addEventListener("msfullscreenchange",
z,!1),m.addEventListener("fullscreenchange",z,!1),y.addEventListener("resize",ga,!1),y.addEventListener("orientationchange",ga,!1),m.addEventListener("keydown",wa,!1),m.addEventListener("keyup",la,!1),m.addEventListener("blur",R,!1),l.addEventListener("mouseleave",fa,!1),F.addEventListener("touchstart",va,!1),F.addEventListener("touchmove",aa,!1),F.addEventListener("touchend",v,!1),F.addEventListener("pointerdown",e,!1),F.addEventListener("pointermove",a,!1),F.addEventListener("pointerup",K,!1),F.addEventListener("pointerleave",
K,!1),y.navigator.pointerEnabled&&(m.style.touchAction="none"));g();setTimeout(function(){},500)}function $(a){var d=new FileReader;d.addEventListener("loadend",function(){var c=d.result;if(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)){var e=c.indexOf("\u00ff\u00c2");(0>e||65536<e)&&S("Due to iOS 8's broken WebGL implementation, only progressive encoded JPEGs work for your device (this panorama uses standard encoding).")}e=c.indexOf("<x:xmpmeta");if(-1<e&&!0!==b.ignoreGPanoXMP){var f=
c.substring(e,c.indexOf("</x:xmpmeta>")+12),g=function(a){var E;0<=f.indexOf(a+'="')?(E=f.substring(f.indexOf(a+'="')+a.length+2),E=E.substring(0,E.indexOf('"'))):0<=f.indexOf(a+">")&&(E=f.substring(f.indexOf(a+">")+a.length+1),E=E.substring(0,E.indexOf("<")));return E!==h?Number(E):null},c=g("GPano:FullPanoWidthPixels"),e=g("GPano:CroppedAreaImageWidthPixels"),k=g("GPano:FullPanoHeightPixels"),l=g("GPano:CroppedAreaImageHeightPixels"),m=g("GPano:CroppedAreaTopPixels"),n=g("GPano:PoseHeadingDegrees"),
p=g("GPano:PosePitchDegrees"),g=g("GPano:PoseRollDegrees");null!==c&&null!==e&&null!==k&&null!==l&&null!==m&&(0>W.indexOf("haov")&&(b.haov=e/c*360),0>W.indexOf("vaov")&&(b.vaov=l/k*180),0>W.indexOf("vOffset")&&(b.vOffset=-180*((m+l/2)/k-0.5)),null!==n&&0>W.indexOf("northOffset")&&(b.northOffset=n,!1!==b.compass&&(b.compass=!0)),null!==p&&null!==g&&(0>W.indexOf("horizonPitch")&&(b.horizonPitch=p),0>W.indexOf("horizonRoll")&&(b.horizonRoll=g)))}M.src=y.URL.createObjectURL(a)});d.readAsBinaryString!==
h?d.readAsBinaryString(a):d.readAsText(a)}function S(a){a===h&&(a="Your browser does not have the necessary WebGL support to display this panorama.");p.errorMsg.innerHTML="<p>"+a+"</p>";t.load.style.display="none";p.load.box.style.display="none";p.errorMsg.style.display="table";Ga=!0;G.style.display="none";pa("error",a)}function ea(a){var d=J(a);Y.style.left=d.x+"px";Y.style.top=d.y+"px";clearTimeout(ea.t1);clearTimeout(ea.t2);Y.style.display="block";Y.style.opacity=1;ea.t1=setTimeout(function(){Y.style.opacity=
0},2E3);ea.t2=setTimeout(function(){Y.style.display="none"},2500);a.preventDefault()}function J(a){var d=m.getBoundingClientRect(),b={};b.x=a.clientX-d.left;b.y=a.clientY-d.top;return b}function ta(a){a.preventDefault();m.focus();if(N){var d=J(a);if(b.hotSpotDebug){var c=ua(a);console.log("Pitch: "+c[0]+", Yaw: "+c[1]+", Center Pitch: "+b.pitch+", Center Yaw: "+b.yaw+", HFOV: "+b.hfov)}Ca();I();b.roll=0;u.hfov=0;ca=!0;P=Date.now();qa=d.x;ra=d.y;Ha=b.yaw;Ia=b.pitch;m.classList.add("pnlm-grabbing");
m.classList.remove("pnlm-grab");pa("mousedown",a);D()}}function ua(a){var d=J(a);a=B.getCanvas();var c=a.width/(y.devicePixelRatio||1),e=a.height/(y.devicePixelRatio||1);a=d.x/c*2-1;var e=(1-d.y/e*2)*e/c,f=1/Math.tan(b.hfov*Math.PI/360),h=Math.sin(b.pitch*Math.PI/180),g=Math.cos(b.pitch*Math.PI/180),d=f*g-e*h,c=Math.sqrt(a*a+d*d),e=180*Math.atan((e*g+f*h)/c)/Math.PI;a=180*Math.atan2(a/c,d/c)/Math.PI+b.yaw;return[e,a]}function ka(a){if(ca&&N){P=Date.now();var d=B.getCanvas(),c=d.width/(y.devicePixelRatio||
1),d=d.height/(y.devicePixelRatio||1);a=J(a);var e=180*(Math.atan(qa/c*2-1)-Math.atan(a.x/c*2-1))/Math.PI*b.hfov/90+Ha;u.yaw=(e-b.yaw)%360*0.2;b.yaw=e;c=360*Math.atan(Math.tan(b.hfov/360*Math.PI)*d/c)/Math.PI;c=180*(Math.atan(a.y/d*2-1)-Math.atan(ra/d*2-1))/Math.PI*c/90+Ia;u.pitch=0.2*(c-b.pitch);b.pitch=c}}function fa(a){ca&&(ca=!1,15<Date.now()-P&&(u.pitch=u.yaw=0),m.classList.add("pnlm-grab"),m.classList.remove("pnlm-grabbing"),P=Date.now(),pa("mouseup",a))}function va(a){if(N){Ca();I();b.roll=
0;u.hfov=0;var d=J(a.targetTouches[0]);qa=d.x;ra=d.y;2==a.targetTouches.length&&(a=J(a.targetTouches[1]),qa+=0.5*(a.x-d.x),ra+=0.5*(a.y-d.y),za=Math.sqrt((d.x-a.x)*(d.x-a.x)+(d.y-a.y)*(d.y-a.y)));ca=!0;P=Date.now();Ha=b.yaw;Ia=b.pitch;D()}}function aa(a){a.preventDefault();N&&(P=Date.now());if(ca&&N){var d=J(a.targetTouches[0]),c=d.x,e=d.y;2==a.targetTouches.length&&-1!=za&&(a=J(a.targetTouches[1]),c+=0.5*(a.x-d.x),e+=0.5*(a.y-d.y),d=Math.sqrt((d.x-a.x)*(d.x-a.x)+(d.y-a.y)*(d.y-a.y)),Q(b.hfov+0.1*
(za-d)),za=d);d=b.hfov/360;c=(qa-c)*d+Ha;u.yaw=(c-b.yaw)%360*0.2;b.yaw=c;e=(e-ra)*d+Ia;u.pitch=0.2*(e-b.pitch);b.pitch=e}}function v(){ca=!1;150<Date.now()-P&&(u.pitch=u.yaw=0);za=-1;P=Date.now()}function e(a){"touch"==a.pointerType&&(da.push(a.pointerId),Aa.push({clientX:a.clientX,clientY:a.clientY}),a.targetTouches=Aa,va(a),a.preventDefault())}function a(a){if("touch"==a.pointerType)for(var d=0;d<da.length;d++)if(a.pointerId==da[d]){Aa[d]={clientX:a.clientX,clientY:a.clientY};a.targetTouches=Aa;
aa(a);break}}function K(a){if("touch"==a.pointerType){for(var d=!1,b=0;b<da.length;b++)a.pointerId==da[b]&&(da[b]=h),da[b]&&(d=!0);d||(da=[],Aa=[],v());a.preventDefault()}}function L(a){a.preventDefault();N&&(Ca(),P=Date.now(),a.wheelDeltaY?(Q(b.hfov-0.05*a.wheelDeltaY),u.hfov=0>a.wheelDelta?1:-1):a.wheelDelta?(Q(b.hfov-0.05*a.wheelDelta),u.hfov=0>a.wheelDelta?1:-1):a.detail&&(Q(b.hfov+1.5*a.detail),u.hfov=0<a.detail?1:-1),D())}function wa(a){a.preventDefault();Ca();P=Date.now();I();b.roll=0;var d=
a.keycode;a.which&&(d=a.which);27==d?Ja&&ja():ba(d,!0)}function R(){for(var a=0;10>a;a++)n[a]=!1}function la(a){a.preventDefault();var d=a.keycode;a.which&&(d=a.which);ba(d,!1)}function ba(a,d){var b=!1;switch(a){case 109:case 189:case 17:n[0]!=d&&(b=!0);n[0]=d;break;case 107:case 187:case 16:n[1]!=d&&(b=!0);n[1]=d;break;case 38:n[2]!=d&&(b=!0);n[2]=d;break;case 87:n[6]!=d&&(b=!0);n[6]=d;break;case 40:n[3]!=d&&(b=!0);n[3]=d;break;case 83:n[7]!=d&&(b=!0);n[7]=d;break;case 37:n[4]!=d&&(b=!0);n[4]=d;
break;case 65:n[8]!=d&&(b=!0);n[8]=d;break;case 39:n[5]!=d&&(b=!0);n[5]=d;break;case 68:n[9]!=d&&(b=!0),n[9]=d}b&&d&&(Z="undefined"!==typeof performance&&performance.now()?performance.now():Date.now(),D())}function r(){if(N){var a=!1,d=b.pitch,c=b.yaw,e=b.hfov,f;f="undefined"!==typeof performance&&performance.now()?performance.now():Date.now();Z===h&&(Z=f);var g=(f-Z)*b.hfov/1700,g=Math.min(g,1);n[0]&&!0===b.keyboardZoom&&(Q(b.hfov+(0.8*u.hfov+0.5)*g),a=!0);n[1]&&!0===b.keyboardZoom&&(Q(b.hfov+(0.8*
u.hfov-0.2)*g),a=!0);if(n[2]||n[6])b.pitch+=(0.8*u.pitch+0.2)*g,a=!0;if(n[3]||n[7])b.pitch+=(0.8*u.pitch-0.2)*g,a=!0;if(n[4]||n[8])b.yaw+=(0.8*u.yaw-0.2)*g,a=!0;if(n[5]||n[9])b.yaw+=(0.8*u.yaw+0.2)*g,a=!0;a&&(P=Date.now());Date.now();if(b.autoRotate){if(0.001<f-Z){var a=(f-Z)/1E3,k=(u.yaw/a*g-0.2*b.autoRotate)*a,k=Math.sign(-b.autoRotate)*Math.min(Math.abs(b.autoRotate*a),Math.abs(k));b.yaw+=k}b.autoRotateStopDelay&&(b.autoRotateStopDelay-=f-Z,0>=b.autoRotateStopDelay&&(b.autoRotateStopDelay=!1,T=
b.autoRotate,b.autoRotate=0))}H.pitch&&(x("pitch"),d=b.pitch);H.yaw&&(x("yaw"),c=b.yaw);H.hfov&&(x("hfov"),e=b.hfov);0<g&&!b.autoRotate&&(n[4]||n[5]||n[8]||n[9]||H.yaw||(b.yaw+=u.yaw*g*0.85),n[2]||n[3]||n[6]||n[7]||H.pitch||(b.pitch+=u.pitch*g*0.85),n[0]||n[1]||H.hfov||Q(b.hfov+u.hfov*g*0.85));Z=f;0<g&&(u.yaw=0.8*u.yaw+(b.yaw-c)/g*0.2,u.pitch=0.8*u.pitch+(b.pitch-d)/g*0.2,u.hfov=0.8*u.hfov+(b.hfov-e)/g*0.2,d=b.autoRotate?Math.abs(b.autoRotate):5,u.yaw=Math.min(d,Math.max(u.yaw,-d)),u.pitch=Math.min(d,
Math.max(u.pitch,-d)),u.hfov=Math.min(d,Math.max(u.hfov,-d)));n[0]&&n[0]&&(u.hfov=0);(n[2]||n[6])&&(n[3]||n[7])&&(u.pitch=0);(n[4]||n[8])&&(n[5]||n[9])&&(u.yaw=0)}}function x(a){var d=H[a],c=Math.min(1,Math.max((Date.now()-d.startTime)/1E3/(d.duration/1E3),0)),c=d.startPosition+(0.5>c?2*c*c:-1+(4-2*c)*c)*(d.endPosition-d.startPosition);if(d.endPosition>d.startPosition&&c>=d.endPosition||d.endPosition<d.startPosition&&c<=d.endPosition)c=d.endPosition,u[a]=0,delete H[a];b[a]=c}function ga(){z()}function D(){Ma||
(Ma=!0,X())}function X(){ma();Na&&clearTimeout(Na);if(ca)requestAnimationFrame(X);else if(n[0]||n[1]||n[2]||n[3]||n[4]||n[5]||n[6]||n[7]||n[8]||n[9]||b.autoRotate||H.pitch||H.yaw||H.hfov||0.01<Math.abs(u.yaw)||0.01<Math.abs(u.pitch)||0.01<Math.abs(u.hfov))r(),0<=b.autoRotateInactivityDelay&&T&&Date.now()-P>b.autoRotateInactivityDelay&&!b.autoRotate&&(b.autoRotate=T,Ka.lookAt(ya,h,xa,3E3)),requestAnimationFrame(X);else if(B&&(B.isLoading()||!0===b.dynamic&&Ta))requestAnimationFrame(X);else{Ma=!1;Z=
h;var a=b.autoRotateInactivityDelay-(Date.now()-P);0<a?Na=setTimeout(function(){b.autoRotate=T;Ka.lookAt(ya,h,xa,3E3);D()},a):0<=b.autoRotateInactivityDelay&&T&&(b.autoRotate=T,Ka.lookAt(ya,h,xa,3E3),D())}}function ma(){var a;if(N){180<b.yaw?b.yaw-=360:-180>b.yaw&&(b.yaw+=360);a=b.yaw;var d=b.maxYaw-b.minYaw,e=-180,f=180;360>d&&(e=b.minYaw+b.hfov/2,f=b.maxYaw-b.hfov/2,d<b.hfov&&(d=b.hfov-d,e-=d,f+=d));b.yaw=Math.max(e,Math.min(f,b.yaw));!1!==b.autoRotate&&a!=b.yaw&&(b.autoRotate*=-1);d=B.getCanvas();
d=2*Math.atan(Math.tan(b.hfov/180*Math.PI*0.5)/(d.width/d.height))/Math.PI*180;a=b.minPitch+d/2;e=b.maxPitch-d/2;f=b.maxPitch-b.minPitch;f<d&&(d-=f,a-=d,e+=d);isNaN(a)&&(a=-90);isNaN(e)&&(e=90);b.pitch=Math.max(a,Math.min(e,b.pitch));B.render(b.pitch*Math.PI/180,b.yaw*Math.PI/180,b.hfov*Math.PI/180,{roll:b.roll*Math.PI/180});b.hotSpots.forEach(c);b.compass&&(Ba.style.transform="rotate("+(-b.yaw-b.northOffset)+"deg)",Ba.style.webkitTransform="rotate("+(-b.yaw-b.northOffset)+"deg)")}}function V(a,b,
c,e){this.w=a;this.x=b;this.y=c;this.z=e}function Ea(a){var d;d=a.alpha;var c=a.beta;a=a.gamma;c=[c?c*Math.PI/180/2:0,a?a*Math.PI/180/2:0,d?d*Math.PI/180/2:0];d=[Math.cos(c[0]),Math.cos(c[1]),Math.cos(c[2])];c=[Math.sin(c[0]),Math.sin(c[1]),Math.sin(c[2])];d=new V(d[0]*d[1]*d[2]-c[0]*c[1]*c[2],c[0]*d[1]*d[2]-d[0]*c[1]*c[2],d[0]*c[1]*d[2]+c[0]*d[1]*c[2],d[0]*d[1]*c[2]+c[0]*c[1]*d[2]);d=d.multiply(new V(Math.sqrt(0.5),-Math.sqrt(0.5),0,0));c=y.orientation?-y.orientation*Math.PI/180/2:0;d=d.multiply(new V(Math.cos(c),
0,-Math.sin(c),0)).toEulerAngles();b.pitch=d[0]/Math.PI*180;b.roll=-d[1]/Math.PI*180;b.yaw=-d[2]/Math.PI*180+b.northOffset;X()}function g(){try{var a={};b.horizonPitch!==h&&(a.horizonPitch=b.horizonPitch*Math.PI/180);b.horizonRoll!==h&&(a.horizonRoll=b.horizonRoll*Math.PI/180);b.backgroundColor!==h&&(a.backgroundColor=b.backgroundColor);B.init(M,b.type,b.dynamic,b.haov*Math.PI/180,b.vaov*Math.PI/180,b.vOffset*Math.PI/180,f,a);!0!==b.dynamic&&(M=h)}catch(d){if("webgl error"==d.type||"no webgl"==d.type)S();
else if("webgl size error"==d.type)S("This panorama is too big for your device! It's "+d.width+"px wide, but your device only supports images up to "+d.maxWidth+"px wide. Try another device. (If you're the author, try scaling down the image.)");else throw S("Unknown error. Check developer console."),d;}}function f(){if(b.sceneFadeDuration&&B.fadeImg!==h){B.fadeImg.style.opacity=0;var a=B.fadeImg;delete B.fadeImg;setTimeout(function(){G.removeChild(a)},b.sceneFadeDuration)}Ba.style.display=b.compass?
"inline":"none";sa();p.load.box.style.display="none";ha!==h&&(G.removeChild(ha),ha=h);N=!0;pa("load");D()}function ia(a){a.pitch=Number(a.pitch)||0;a.yaw=Number(a.yaw)||0;var d=l.createElement("div");d.className="pnlm-hotspot-base";d.className=a.cssClass?d.className+(" "+a.cssClass):d.className+(" pnlm-hotspot pnlm-sprite pnlm-"+Da(a.type));var c=l.createElement("span");a.text&&(c.innerHTML=Da(a.text));var e;if(a.video){e=l.createElement("video");var f=a.video;b.basePath&&!na(f)&&(f=b.basePath+f);
e.src=encodeURI(f);e.controls=!0;e.style.width=a.width+"px";G.appendChild(d);c.appendChild(e)}else if(a.image){f=a.image;b.basePath&&!na(f)&&(f=b.basePath+f);e=l.createElement("a");e.href=encodeURI(a.URL?a.URL:f);e.target="_blank";c.appendChild(e);var g=l.createElement("img");g.src=encodeURI(f);g.style.width=a.width+"px";g.style.paddingTop="5px";G.appendChild(d);e.appendChild(g);c.style.maxWidth="initial"}else a.URL?(e=l.createElement("a"),e.href=encodeURI(a.URL),e.target="_blank",G.appendChild(e),
d.style.cursor="pointer",c.style.cursor="pointer",e.appendChild(d)):(a.sceneId&&(d.onclick=function(){C(a.sceneId,a.targetPitch,a.targetYaw,a.targetHfov);return!1},d.ontouchend=function(){C(a.sceneId,a.targetPitch,a.targetYaw,a.targetHfov);return!1},d.style.cursor="pointer",c.style.cursor="pointer"),G.appendChild(d));if(a.createTooltipFunc)a.createTooltipFunc(d,a.createTooltipArgs);else if(a.text||a.video||a.image)d.classList.add("pnlm-tooltip"),d.appendChild(c),c.style.width=c.scrollWidth-20+"px",
c.style.marginLeft=-(c.scrollWidth-d.offsetWidth)/2+"px",c.style.marginTop=-c.scrollHeight-12+"px";a.div=d}function sa(){Oa||(b.hotSpots?(b.hotSpots=b.hotSpots.sort(function(a,b){return a.pitch<b.pitch}),b.hotSpots.forEach(ia)):b.hotSpots=[],Oa=!0,b.hotSpots.forEach(c))}function q(){if(b.hotSpots)for(var a=0;a<b.hotSpots.length;a++){for(var d=b.hotSpots[a].div;d.parentNode!=G;)d=d.parentNode;G.removeChild(d);delete b.hotSpots[a].div}Oa=!1;delete b.hotSpots}function c(a){var d=Math.sin(a.pitch*Math.PI/
180),c=Math.cos(a.pitch*Math.PI/180),e=Math.sin(b.pitch*Math.PI/180),f=Math.cos(b.pitch*Math.PI/180),g=Math.cos((-a.yaw+b.yaw)*Math.PI/180),h=Math.tan(b.hfov*Math.PI/360),k=d*e+c*g*f;if(90>=a.yaw&&-90<a.yaw&&0>=k||(90<a.yaw||-90>=a.yaw)&&0>=k)a.div.style.visibility="hidden";else{a.div.style.visibility="visible";var l=B.getCanvas(),m=l.width/(y.devicePixelRatio||1),l=l.height/(y.devicePixelRatio||1),d="translate("+(-m/h*Math.sin((-a.yaw+b.yaw)*Math.PI/180)*c/k/2+(m-a.div.offsetWidth)/2)+"px, "+(-m/
h*(d*f-c*g*e)/k/2+(l-a.div.offsetHeight)/2)+"px) translateZ(9999px)";a.div.style.webkitTransform=d;a.div.style.MozTransform=d;a.div.style.transform=d}}function k(a){b={};var d,c="haov vaov vOffset northOffset horizonPitch horizonRoll".split(" ");W=[];for(d in Pa)Pa.hasOwnProperty(d)&&(b[d]=Pa[d]);for(d in w.default)w.default.hasOwnProperty(d)&&(b[d]=w.default[d],0<=c.indexOf(d)&&W.push(d));if(null!==a&&""!==a&&w.scenes&&w.scenes[a]){var e=w.scenes[a];for(d in e)e.hasOwnProperty(d)&&(b[d]=e[d],0<=
c.indexOf(d)&&W.push(d));b.scene=a}for(d in w)w.hasOwnProperty(d)&&(b[d]=w[d],0<=c.indexOf(d)&&W.push(d))}function s(){if("preview"in b){var a=b.preview;b.basePath&&(a=b.basePath+a);ha=l.createElement("div");ha.className="pnlm-preview-img";ha.style.backgroundImage="url('"+encodeURI(a)+"')";G.appendChild(ha)}b.hasOwnProperty("title")||(p.title.innerHTML="");b.hasOwnProperty("author")||(p.author.innerHTML="");b.hasOwnProperty("title")||b.hasOwnProperty("author")||(p.container.style.display="none");
for(var d in b)if(b.hasOwnProperty(d))switch(d){case "title":p.title.innerHTML=Da(b[d]);p.container.style.display="inline";break;case "author":p.author.innerHTML="by "+Da(b[d]);p.container.style.display="inline";break;case "fallback":p.errorMsg.innerHTML='<p>Your browser does not support WebGL.<br><a href="'+encodeURI(b[d])+'" target="_blank">Click here to view this panorama in an alternative viewer.</a></p>';break;case "hfov":Q(Number(b[d]));break;case "autoLoad":!0===b[d]&&B===h&&(p.load.box.style.display=
"inline",t.load.style.display="none",Fa());break;case "showZoomCtrl":t.zoom.style.display=b[d]&&!1!=b.showControls?"block":"none";break;case "showFullscreenCtrl":t.fullscreen.style.display=b[d]&&!1!=b.showControls&&("fullscreen"in l||"mozFullScreen"in l||"webkitIsFullScreen"in l||"msFullscreenElement"in l)?"block":"none";break;case "hotSpotDebug":Qa.style.display=b[d]?"block":"none";break;case "showControls":b[d]||(t.orientation.style.display="none",t.zoom.style.display="none",t.fullscreen.style.display=
"none");break;case "orientationOnByDefault":b[d]&&Sa()}}function ja(){if(N&&!Ga)if(Ja)l.exitFullscreen?l.exitFullscreen():l.mozCancelFullScreen?l.mozCancelFullScreen():l.webkitCancelFullScreen?l.webkitCancelFullScreen():l.msExitFullscreen&&l.msExitFullscreen();else try{m.requestFullscreen?m.requestFullscreen():m.mozRequestFullScreen?m.mozRequestFullScreen():m.msRequestFullscreen?m.msRequestFullscreen():m.webkitRequestFullScreen()}catch(a){}}function z(){l.fullscreen||l.mozFullScreen||l.webkitIsFullScreen||
l.msFullscreenElement?(t.fullscreen.classList.add("pnlm-fullscreen-toggle-button-active"),Ja=!0):(t.fullscreen.classList.remove("pnlm-fullscreen-toggle-button-active"),Ja=!1);B.resize();Q(b.hfov);D()}function A(a){var d=b.minHfov;"multires"==b.type&&B&&(d=Math.min(d,B.getCanvas().width/(b.multiRes.cubeResolution/90*0.9)));return d>b.maxHfov?(console.log("HFOV bounds do not make sense (minHfov > maxHfov)."),b.hfov):a<d?d:a>b.maxHfov?b.maxHfov:a}function Q(a){b.hfov=A(a)}function Ca(){H={};T=b.autoRotate?
b.autoRotate:T;b.autoRotate=!1}function O(){Ga&&(p.load.box.style.display="none",p.errorMsg.style.display="none",Ga=!1,pa("errorcleared"));t.load.style.display="none";p.load.box.style.display="inline";Fa()}function C(a,d,c,e,f){N=!1;H={};var g,l;b.sceneFadeDuration&&!f?(f=new Image,f.className="pnlm-fade-img",f.style.transition="opacity "+b.sceneFadeDuration/1E3+"s",f.style.width="100%",f.style.height="100%",f.onload=function(){C(a,d,c,e,!0)},g=B.render(b.pitch*Math.PI/180,b.yaw*Math.PI/180,b.hfov*
Math.PI/180,{returnImage:!0}),g!==h&&(f.src=g),G.appendChild(f),B.fadeImg=f):(f="same"===d?b.pitch:d,g="same"===c?b.yaw:"sameAzimuth"===c?b.yaw+b.northOffset-w.scenes[a].northOffset:c,l="same"===e?b.hfov:e,q(),k(a),u.yaw=u.pitch=u.hfov=0,s(),f!==h&&(b.pitch=f),g!==h&&(b.yaw=g),l!==h&&(b.hfov=l),pa("scenechange",a),O())}function I(){y.removeEventListener("deviceorientation",Ea);t.orientation.classList.remove("pnlm-orientation-button-active");Ra=!1}function Sa(){Ra=!0;y.addEventListener("deviceorientation",
Ea);t.orientation.classList.add("pnlm-orientation-button-active")}function Da(a){return String(a).replace(/&/g,"&amp;").replace('"',"&quot;").replace("'","&#39;").replace("<","&lt;").replace(">","&gt;").replace("/","&#x2f;")}function pa(a){if(a in U)for(var b=0;b<U[a].length;b++)U[a][b].apply(null,[].slice.call(arguments,1))}var Ka=this,b,B,ha,ca=!1,P=Date.now(),qa=0,ra=0,za=-1,Ha=0,Ia=0,n=Array(10),Ja=!1,N=!1,Ga=!1,La=!1,M,Z,u={yaw:0,pitch:0,hfov:0},Ma=!1,Ra=!1,Na,T=0,xa,ya,H={},U={},W=[],Ta=!1,
Oa=!1,Pa={hfov:100,minHfov:50,maxHfov:120,pitch:0,minPitch:h,maxPitch:h,yaw:0,minYaw:-180,maxYaw:180,roll:0,haov:360,vaov:180,vOffset:0,autoRotate:!1,autoRotateInactivityDelay:-1,autoRotateStopDelay:h,type:"equirectangular",northOffset:0,showFullscreenCtrl:!0,dynamic:!1,keyboardZoom:!0,mouseZoom:!0,showZoomCtrl:!0,autoLoad:!1,showControls:!0,orientationOnByDefault:!1,hotSpotDebug:!1,backgroundColor:[0,0,0]};m="string"===typeof m?l.getElementById(m):m;m.classList.add("pnlm-container");m.tabIndex=0;
var G=l.createElement("div");G.className="pnlm-render-container";m.appendChild(G);var F=l.createElement("div");F.className="pnlm-dragfix";m.appendChild(F);var Y=l.createElement("span");Y.className="pnlm-about-msg";Y.innerHTML='<a href="https://pannellum.org/" target="_blank">Pannellum</a> b312327';m.appendChild(Y);F.addEventListener("contextmenu",ea);var p={},Qa=l.createElement("div");Qa.className="pnlm-sprite pnlm-hot-spot-debug-indicator";m.appendChild(Qa);p.container=l.createElement("div");p.container.className=
"pnlm-panorama-info";p.title=l.createElement("div");p.title.className="pnlm-title-box";p.container.appendChild(p.title);p.author=l.createElement("div");p.author.className="pnlm-author-box";p.container.appendChild(p.author);m.appendChild(p.container);p.load={};p.load.box=l.createElement("div");p.load.box.className="pnlm-load-box";p.load.box.innerHTML="<p>Loading...</p>";p.load.lbox=l.createElement("div");p.load.lbox.className="pnlm-lbox";p.load.lbox.innerHTML='<div class="pnlm-loading"></div>';p.load.box.appendChild(p.load.lbox);
p.load.lbar=l.createElement("div");p.load.lbar.className="pnlm-lbar";p.load.lbarFill=l.createElement("div");p.load.lbarFill.className="pnlm-lbar-fill";p.load.lbar.appendChild(p.load.lbarFill);p.load.box.appendChild(p.load.lbar);p.load.msg=l.createElement("p");p.load.msg.className="pnlm-lmsg";p.load.box.appendChild(p.load.msg);m.appendChild(p.load.box);p.errorMsg=l.createElement("div");p.errorMsg.className="pnlm-error-msg pnlm-info-box";m.appendChild(p.errorMsg);var t={};t.container=l.createElement("div");
t.container.className="pnlm-controls-container";m.appendChild(t.container);t.load=l.createElement("div");t.load.className="pnlm-load-button";t.load.innerHTML="<p>Click to<br>Load<br>Panorama<p>";t.load.addEventListener("click",O);m.appendChild(t.load);t.zoom=l.createElement("div");t.zoom.className="pnlm-zoom-controls pnlm-controls";t.zoomIn=l.createElement("div");t.zoomIn.className="pnlm-zoom-in pnlm-sprite pnlm-control";t.zoomIn.addEventListener("click",function(){N&&(Q(b.hfov-5),D())});t.zoom.appendChild(t.zoomIn);
t.zoomOut=l.createElement("div");t.zoomOut.className="pnlm-zoom-out pnlm-sprite pnlm-control";t.zoomOut.addEventListener("click",function(){N&&(Q(b.hfov+5),D())});t.zoom.appendChild(t.zoomOut);t.container.appendChild(t.zoom);t.fullscreen=l.createElement("div");t.fullscreen.addEventListener("click",ja);t.fullscreen.className="pnlm-fullscreen-toggle-button pnlm-sprite pnlm-fullscreen-toggle-button-inactive pnlm-controls pnlm-control";(l.fullscreenEnabled||l.mozFullScreenEnabled||l.webkitFullscreenEnabled||
l.msFullscreenEnabled)&&t.container.appendChild(t.fullscreen);t.orientation=l.createElement("div");t.orientation.addEventListener("click",function(a){Ra?I():Sa()});t.orientation.addEventListener("mousedown",function(a){a.stopPropagation()});t.orientation.addEventListener("touchstart",function(a){a.stopPropagation()});t.orientation.addEventListener("pointerdown",function(a){a.stopPropagation()});t.orientation.className="pnlm-orientation-button pnlm-orientation-button-inactive pnlm-sprite pnlm-controls pnlm-control";
y.DeviceOrientationEvent&&y.addEventListener("deviceorientation",function(a){y.removeEventListener("deviceorientation",this);a&&null!==a.alpha&&null!==a.beta&&null!==a.gamma&&t.container.appendChild(t.orientation)});var Ba=l.createElement("div");Ba.className="pnlm-compass pnlm-controls pnlm-control";m.appendChild(Ba);w.firstScene?k(w.firstScene):w.default&&w.default.firstScene?k(w.default.firstScene):k(null);s();var da=[],Aa=[];V.prototype.multiply=function(a){return new V(this.w*a.w-this.x*a.x-this.y*
a.y-this.z*a.z,this.x*a.w+this.w*a.x+this.y*a.z-this.z*a.y,this.y*a.w+this.w*a.y+this.z*a.x-this.x*a.z,this.z*a.w+this.w*a.z+this.x*a.y-this.y*a.x)};V.prototype.toEulerAngles=function(){var a=Math.atan2(2*(this.w*this.x+this.y*this.z),1-2*(this.x*this.x+this.y*this.y)),b=Math.asin(2*(this.w*this.y-this.z*this.x)),c=Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(this.y*this.y+this.z*this.z));return[a,b,c]};this.getPitch=function(){return b.pitch};this.setPitch=function(a,d){(d=d==h?1E3:Number(d))?
H.pitch={startTime:Date.now(),startPosition:b.pitch,endPosition:a,duration:d}:b.pitch=a;D();return this};this.getPitchBounds=function(){return[b.minPitch,b.maxPitch]};this.setPitchBounds=function(a){b.minPitch=Math.max(-90,Math.min(a[0],90));b.maxPitch=Math.max(-90,Math.min(a[1],90));return this};this.getYaw=function(){return b.yaw};this.setYaw=function(a,d){for(;180<a;)a-=360;for(;-180>a;)a+=360;(d=d==h?1E3:Number(d))?H.yaw={startTime:Date.now(),startPosition:b.yaw,endPosition:a,duration:d}:b.yaw=
a;D();return this};this.getYawBounds=function(){return[b.minYaw,b.maxYaw]};this.setYawBounds=function(a){b.minYaw=Math.max(-180,Math.min(a[0],180));b.maxYaw=Math.max(-180,Math.min(a[1],180));return this};this.getHfov=function(){return b.hfov};this.setHfov=function(a,d){(d=d==h?1E3:Number(d))?H.hfov={startTime:Date.now(),startPosition:b.hfov,endPosition:A(a),duration:d}:Q(a);D();return this};this.getHfovBounds=function(){return[b.minHfov,b.maxHfov]};this.setHfovBounds=function(a){b.minHfov=Math.max(0,
a[0]);b.maxHfov=Math.max(0,a[1]);return this};this.lookAt=function(a,b,c,e){e=e==h?1E3:Number(e);a!==h&&this.setPitch(a,e);b!==h&&this.setYaw(b,e);c!==h&&this.setHfov(c,e);return this};this.getNorthOffset=function(){return b.northOffset};this.setNorthOffset=function(a){b.northOffset=Math.max(360,Math.min(0,a));D();return this};this.startAutoRotate=function(a){a=a||T||1;b.autoRotate=a;Ka.lookAt(ya,h,xa,3E3);D();return this};this.stopAutoRotate=function(){T=b.autoRotate?b.autoRotate:T;b.autoRotate=
!1;b.autoRotateInactivityDelay=-1;return this};this.getRenderer=function(){return B};this.setUpdate=function(a){Ta=!0===a;B===h?oa():D();return this};this.mouseEventToCoords=function(a){return ua(a)};this.loadScene=function(a,b,c,e){N&&C(a,b,c,e);return this};this.getScene=function(){return b.scene};this.addScene=function(a,b){w.scenes[a]=b;return this};this.removeScene=function(a){if(b.scene===a||!w.scenes.hasOwnProperty(a))return!1;delete w.scenes[a];return!0};this.toggleFullscreen=function(){ja();
return this};this.getConfig=function(){return b};this.addHotSpot=function(a,d){if(d===h||b.scene==d)ia(a),b.hotSpots.push(a),c(a);else if(w.scenes.hasOwnProperty(d))w.scenes[d].hotSpots.push(a);else throw"Invalid scene ID!";return this};this.removeHotSpot=function(a){if(!b.hotSpots)return!1;for(var c=0;c<b.hotSpots.length;c++)if(b.hotSpots[c].hasOwnProperty("id")&&b.hotSpots[c].id===a){for(a=b.hotSpots[c].div;a.parentNode!=G;)a=a.parentNode;G.removeChild(a);delete b.hotSpots[c].div;b.hotSpots.splice(c,
1);return!0}return!1};this.on=function(a,b){U[a]=U[a]||[];U[a].push(b);return this};this.off=function(a,b){if(!a)return U={},this;if(b){var c=U[a].indexOf(b);0<=c&&U[a].splice(c,1);U[a].length=0}else delete U[a];return this};this.destroy=function(){B&&B.destroy();La&&(F.removeEventListener("mousedown",ta,!1),l.removeEventListener("mousemove",ka,!1),l.removeEventListener("mouseup",fa,!1),m.removeEventListener("mousewheel",L,!1),m.removeEventListener("DOMMouseScroll",L,!1),m.removeEventListener("mozfullscreenchange",
z,!1),m.removeEventListener("webkitfullscreenchange",z,!1),m.removeEventListener("msfullscreenchange",z,!1),m.removeEventListener("fullscreenchange",z,!1),y.removeEventListener("resize",ga,!1),y.removeEventListener("orientationchange",ga,!1),m.removeEventListener("keydown",wa,!1),m.removeEventListener("keyup",la,!1),m.removeEventListener("blur",R,!1),l.removeEventListener("mouseleave",fa,!1),F.removeEventListener("touchstart",va,!1),F.removeEventListener("touchmove",aa,!1),F.removeEventListener("touchend",
v,!1),F.removeEventListener("pointerdown",e,!1),F.removeEventListener("pointermove",a,!1),F.removeEventListener("pointerup",K,!1),F.removeEventListener("pointerleave",K,!1));m.innerHTML="";m.classList.remove("pnlm-container");m.classList.remove("pnlm-grab");m.classList.remove("pnlm-grabbing")}}return{viewer:function(h,l){return new ia(h,l)}}}(window,document);
